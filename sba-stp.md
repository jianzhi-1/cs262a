# Semantic Block-Level Analysis and Semantic Trace Playback

### What is the problem being solved?

The problem is to analyse file system's internal behaviour (rather than collecting metrics) and evaluating file system changes (without the need for direct simulation). To create a new methodology for file system benchmarking.

### How was this problem solved previously?

The previous analysis workflow was: apply synthetic or real workloads and measure the resulting performance for a sequence of file system operations. The issue is that this approach does not collect disk traffic and therefore, it was difficult to discover the reasons for the observed performance. Another way was to instrument the file system (2.1.4), which requires the source code.

For evaluating changes, previous methods involve either implementing the idea and measuring the performance of the new system (time consuming and might require fallbacks) or building an accurate simulation of the file system (similarly expensive and need to set up a new environment). (2.2)

### What is the main idea?

SBA: Use block tracing (obtaining a stream of read and write request at the block-level) to provide insight about the internal behaviour of a file system. This is done by inserting a "pseudo-device driver" in the kernel associated with an underlying disk. When the driver passes the traffic to and from the disk, it tracks each request and response. The driver is also customised to the file system under test, so it also understands the on-disk format of the file system. 

STP: implemented as a user-level process that takes the trace generated by the SBA and issues I/O to disk.

### What are the key results?

The analysis of several file systems, focusing on ext3 and ReiserFS, was done and their strengths and weaknesses were proposed. 

Discovered tangled synchrony problem in ext3's compound transaction implementiation (where asynchronous traffic must wait for synchronous updates to complete); discovered an extraneous wait which falsely limited parallelism (3.2.2); identified early and frequent flushing behaviour (3.2.3). Used STP to validate that fixes actually fixed the problems.

Found a variety of bugs in ReiserFS and alerted the developers.

### What are the main limitations of this paper?

SBA must be customised to the file system under test (2.1); this still requires the changing of parts of the code.

STP relies on SBA (dependency). It is limited to evaluating design alternatives under simpler benchmarks, evaluating file system changes that keep the basic operations intact (for the trace). It does not evaluate the implementation of the additional feature. (2.2) It also requires the construction of a specific workload to observe specific features of the file system.

### Why did this paper have an impact?

It can be applied to all journalling file systems; does not require source code of the file system; device code can be mostly reused. Hence, it was applicable to finding flaws/bugs in many existing file system. However, new file systems do not appear that often, and features were not that frequent, so I think it has less of an impact after one use.

From a security point of view, it is a tool to infer policies and parameters (2.1.1).
